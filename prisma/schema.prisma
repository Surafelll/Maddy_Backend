// Datasource and generator configuration
datasource db {
    provider = "mysql"
    url      = env("DATABASE_URL")
}

generator client {
    provider = "prisma-client-js"
}

// Product model
model Product {
    id           Int       @id @default(autoincrement())
    name         String    @unique
    description  String
    price        Float
    quantity     Int
    imageUrl     String?
    expiryDate   DateTime?
    categoryName String
    createdAt    DateTime  @default(now())
    updatedAt    DateTime  @updatedAt

    category Category      @relation(fields: [categoryName], references: [name], onDelete: Cascade)
    sales    SoldProduct[] // Relation to sold products
}

// Category model
model Category {
    id          Int     @id @default(autoincrement())
    name        String  @unique
    type        String
    description String?

    products Product[]
}

// SoldProduct model for tracking sales history
model SoldProduct {
    id          Int      @id @default(autoincrement())
    productId   Int // Foreign key to Product
    productName String // Product name at the time of sale
    quantity    Int // Quantity sold
    price       Float // Price per unit at the time of sale
    totalAmount Float // Total sale amount
    soldAt      DateTime @default(now())

    // Make these optional temporarily
    imageUrl     String? // Image URL at the time of sale
    categoryName String? // Category name at the time of sale

    product Product @relation(fields: [productId], references: [id])
}
