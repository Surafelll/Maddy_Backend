// datasource and generator configuration
datasource db {
    provider = "mysql" // Specify MySQL as the database provider
    url      = env("DATABASE_URL") // Fetch connection details from .env file
}

generator client {
    provider = "prisma-client-js" // Generate JavaScript/TypeScript Prisma client
}

// Product model
model Product {
    id           Int       @id @default(autoincrement())
    name         String    @unique // Ensure product name is unique
    description  String
    price        Float
    quantity     Int
    imageUrl     String?
    expiryDate   DateTime?
    categoryName String // Category name reference
    createdAt    DateTime  @default(now())
    updatedAt    DateTime  @updatedAt

    category     Category      @relation(fields: [categoryName], references: [name], onDelete: Cascade)
    transactions Transaction[]
}

// Category model
model Category {
    id          Int     @id @default(autoincrement()) // Unique ID for each category
    name        String  @unique // Ensure category name is unique
    type        String // Type of the category (e.g., Electronics, Groceries)
    description String? // Optional description of the category

    // Relations
    products Product[] // All products belonging to this category
}

// Transaction model
model Transaction {
    id          Int      @id @default(autoincrement()) // Unique ID for each transaction
    productId   Int? // Nullable foreign key to Product (for retaining transaction after product deletion)
    quantity    Int // Quantity of the product sold
    totalAmount Float // Total price for the sold quantity
    soldAt      DateTime @default(now()) // Date of the transaction

    // Relations
    product Product? @relation(fields: [productId], references: [id], onDelete: SetNull) // Link to Product sold
}

// Report model
model Report {
    id         Int      @id @default(autoincrement()) // Unique ID for each report
    startDate  DateTime // Start date for the report period
    endDate    DateTime // End date for the report period
    totalSales Float // Total sales during the report period
    createdAt  DateTime @default(now()) // Timestamp when the report is generated
}

// Sale model
model Sale {
    id        Int      @id @default(autoincrement())
    productId Int // Reference to product
    price     Float // Price per unit
    quantity  Int // Number of units sold
    createdAt DateTime @default(now())
}
